<!DOCTYPE html>
<html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Escuela Caleta San Marcos - SLEP IQUIQUE</title><link rel="stylesheet" href="../style.css"><style>.est-table-wrap{margin-top:.8rem;border:1px solid #e5e7eb;border-radius:10px;overflow:auto}table.est{width:100%;border-collapse:collapse}table.est th,table.est td{border:1px solid #e5e7eb;padding:.5rem .6rem;text-align:left}table.est thead th{background:linear-gradient(180deg,#f8fafc,#eef2ff);font-size:.85rem;color:#334155;position:sticky;top:0}.muted{opacity:.7;font-size:.9rem}</style></head><body><main style="max-width:900px;margin:0 auto;padding:1rem;"><section style="background:#fff;border:1px solid #e5e7eb;border-radius:14px;padding:1rem 1.2rem;box-shadow:0 8px 18px -12px rgba(15,23,42,.15);"><h1>Convivencia Escolar</h1><h2 style="margin:.2rem 0 .6rem;">Escuela Caleta San Marcos</h2><p style="opacity:.8;">Sección en construcción.</p><div class="est-table-wrap"><table class="est"><thead><tr><th>NOMBRE COMPLETO</th><th>MES</th><th>RBD</th><th>CURSO</th><th>TOTAL AUSENCIAS</th><th>DÍAS AUSENTES</th></tr></thead><tbody id="rows"><tr><td colspan="6" class="muted">Sin registros</td></tr></tbody></table></div><div style="margin-top:1rem;"><a href="../convivencia_escolar.html">← Galería</a></div></section></main>
<script>
(function(){try{const wrap=document.querySelector('.est-table-wrap');const rowsTbody=document.getElementById('rows');if(!wrap||!rowsTbody)return;const style=document.createElement('style');style.textContent=`.filters-row{display:flex;flex-wrap:wrap;gap:.6rem;align-items:flex-end;margin-top:.8rem}.filters-row .group{display:flex;flex-direction:column;gap:.25rem}.filters-row label{font-size:.85rem;opacity:.85}.filters-row select{padding:.45rem .6rem;border:1px solid #cbd5e1;border-radius:8px;background:#fff;color:#0f172a}.filters-row button{padding:.45rem .8rem;border:1px solid #e5e7eb;border-radius:8px;background:#111827;color:#fff;cursor:pointer}`;document.head.appendChild(style);const filters=document.createElement('div');filters.className='filters-row';filters.innerHTML=`<div class=\"group\"><label for=\"mesSelect\">Mes<\/label><select id=\"mesSelect\"><option value=\"\">Todos<\/option><option value=\"01\">Enero<\/option><option value=\"02\">Febrero<\/option><option value=\"03\">Marzo<\/option><option value=\"04\">Abril<\/option><option value=\"05\">Mayo<\/option><option value=\"06\">Junio<\/option><option value=\"07\">Julio<\/option><option value=\"08\">Agosto<\/option><option value=\"09\">Septiembre<\/option><option value=\"10\">Octubre<\/option><option value=\"11\">Noviembre<\/option><option value=\"12\">Diciembre<\/option><\/select><\/div><div class=\"group\"><label for=\"anioSelect\">Año<\/label><select id=\"anioSelect\"><option value=\"\">Todos<\/option><\/select><\/div><div class=\"group\"><label for=\"cursoSelect\">Curso<\/label><select id=\"cursoSelect\"><option value=\"\">Todos<\/option><\/select><\/div><div class=\"group\" style=\"gap:.4rem;\"><button id=\"btnClearFiltros\" type=\"button\">Limpiar filtro<\/button><\/div>`;wrap.parentNode.insertBefore(filters,wrap);const mesSel=filters.querySelector('#mesSelect');const anioSel=filters.querySelector('#anioSelect');const cursoSel=filters.querySelector('#cursoSelect');const btnClear=filters.querySelector('#btnClearFiltros');const table=wrap.querySelector('table');const headCells=Array.from(table.querySelectorAll('thead th')).map(th=>(th.textContent||'').trim().toLowerCase());let mesIdx=headCells.findIndex(t=>t==='mes');if(mesIdx<0)mesIdx=1;let cursoIdx=headCells.findIndex(t=>t.startsWith('curso'));if(cursoIdx<0)cursoIdx=3;const getDataRows=()=>Array.from(rowsTbody.querySelectorAll('tr')).filter(tr=>!tr.querySelector('.muted'));const MONTHS={enero:'01',febrero:'02',marzo:'03',abril:'04',mayo:'05',junio:'06',julio:'07',agosto:'08',septiembre:'09',setiembre:'09',octubre:'10',noviembre:'11',diciembre:'12'};function parseMesAnio(text){const t=(text||'').toString().trim();if(!t)return{mm:'',yyyy:''};let m=t.match(/^(\d{1,2})[\/-](\d{4})$/);if(m){const mm=m[1].padStart(2,'0');const yyyy=m[2];return{mm,yyyy}}m=t.match(/^(\d{4})[\/-](\d{1,2})$/);if(m){const yyyy=m[1];const mm=m[2].padStart(2,'0');return{mm,yyyy}}const low=t.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,'');for(const name in MONTHS){if(low.includes(name)){const mm=MONTHS[name];const y=low.match(/(19|20)\d{2}/)?.[0]||'';return{mm,yyyy:y}}}const yonly=t.match(/(19|20)\d{2}/)?.[0]||'';return{mm:'',yyyy:yonly}}function applyFilters(){const fmm=mesSel.value;const fy=anioSel.value;const fcurso=(cursoSel.value||'').toString().trim().toLowerCase();let visible=0;for(const tr of getDataRows()){const mesCell=tr.children?.[mesIdx]?.textContent||'';const cursoCell=(tr.children?.[cursoIdx]?.textContent||'').toString().trim().toLowerCase();const{mm,yyyy}=parseMesAnio(mesCell);const okMes=!fmm||(mm===fmm);const okAnio=!fy||(yyyy===fy);const okCurso=!fcurso||(cursoCell===fcurso);const show=okMes&&okAnio&&okCurso;tr.style.display=show?'':'none';if(show)visible++}const emptyRow=rowsTbody.querySelector('tr .muted')?.parentElement||null;if(emptyRow){emptyRow.style.display=visible?'none':''}}function populateYears(){if(!anioSel)return;if((anioSel.options?.length||0)>1){anioSel.disabled=false;return}const years=new Set();for(const tr of getDataRows()){const mesCell=tr.children?.[mesIdx]?.textContent||'';const{yyyy}=parseMesAnio(mesCell);if(yyyy)years.add(String(yyyy))}let arr=Array.from(years).sort((a,b)=>b.localeCompare(a));if(arr.length===0){const cur=new Date().getFullYear();arr=[String(cur),String(cur-1),String(cur-2)]}anioSel.innerHTML=['<option value="">Todos</option>'].concat(arr.map(y=>`<option value="${y}">${y}</option>`)).join('');anioSel.disabled=false}function populateCourses(){if(!cursoSel)return;const set=new Set();for(const tr of getDataRows()){const c=(tr.children?.[cursoIdx]?.textContent||'').toString().trim();if(c)set.add(c)}const arr=Array.from(set).sort((a,b)=>a.localeCompare(b,'es',{numeric:true,sensitivity:'base'}));cursoSel.innerHTML=['<option value="">Todos</option>'].concat(arr.map(v=>`<option value="${v}">${v}</option>`)).join('');cursoSel.disabled=arr.length===0}mesSel?.addEventListener('change',applyFilters);anioSel?.addEventListener('change',applyFilters);cursoSel?.addEventListener('change',applyFilters);btnClear?.addEventListener('click',()=>{mesSel.value='';anioSel.value='';cursoSel.value='';applyFilters()});populateYears();populateCourses();applyFilters()}catch(e){console.warn('filtros C.E. error',e)}})();
</script>
<script src="./est-header-logo.js"></script>
</body>
</html>
